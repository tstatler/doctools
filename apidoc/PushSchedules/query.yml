name: PushSchedules
methods:
  - name: query
    summary: query
    description: |
        Queries the list of scheduled push notifications.

        This feature is only available for Enterprise users.

        The current user must be an application admin.
    url: push_schedule/query.json
    http-method: GET
    login-required: true
    admin-required: true

    parameters:

      - name: name
        description: Name given to the scheduled push notification.
        type: String

      - name: page
        description: Request page number, default is 1.
        type: Number

      - name: per_page
        description: Number of results per page, default is 10.
        type: Number
        
      - name: pretty_print
        description: | 
            Determines if the JSON response is formatted for readability (`true`), or displayed on a
            single line (`false`). Default is `false`.
        type: Boolean

    response-parameters:
      - name: push_schedules
        description: |
            A list of scheduled push notifications matching the query.
        type: Array<PushSchedules>
      
    examples:

      - platform: titanium
        example: |
            Available on Release 3.2.0 and later.

                Cloud.PushSchedules.query({}, function(e) {
                    if (e.success) {
                        Ti.API.info("List of scheduled push notifications:");
                        e.push_schedules.forEach(function(push){
                            Ti.API.info("\t" + push.name);
                        }
                    } else {
                        Ti.API.error('Error: ' + ((e.error && e.message) || JSON.stringify(e)));
                    }
                });
    
      - platform: rest
        example: |
            Example cURL request:

                curl -b cookies.txt -c cookies.txt "https://api.cloud.appcelerator.com/v1/push_schedules/query.json?key=<APP_API_KEY>"

            Example JSON response:

                {
                  "meta": {
                    "code": 200,
                    "status": "ok",
                    "method_name": "queryPushSchedules",
                    "page": 1,
                    "per_page": 10,
                    "total_pages": 1,
                    "total_results": 1
                  },
                  "response": {
                    "push_schedules": [
                      {
                        "id": "526ae82db93e7206700001e1",
                        "name": "test",
                        "start_time": "2013-10-24T00:00:00+0000",
                        "push_notification": {
                          "channel": "test",
                          "payload": "test schedule"
                        },
                        "recurrence": {
                          "interval": "daily",
                          "end_time": "2013-10-31T00:00:00+0000"
                        }
                      }
                    ]
                  }
                }

      - platform: ios
        example: |
            Example iOS APS SDK call:

                [APSPushSchedules query:nil withBlock:^(APSResponse *e) {
                      if (e.success) {
                          NSString *message = [NSString stringWithFormat:@"Found %lu push_schedules", (unsigned long)((NSArray *) e.response[@"push_schedules"]).count ];
                          [[[UIAlertView alloc] initWithTitle:@"Success" message:message delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil] show];
                      } else {
                          [[[UIAlertView alloc] initWithTitle:@"Error" message:e.errorMessage delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil] show];
                      }
                }];
