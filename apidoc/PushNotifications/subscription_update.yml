name: PushNotifications
methods:
  - name: subscription_update
    summary: Update the Subscription

    description: |
        Updates the device's push channel subscription.
    url: push_notification/subscription/update.json
    http-method: PUT
    login-required: true

    parameters: 

      - name: channel
        description: |
            Push notification channel to update.

            The name of the push channel cannot start with a hash symbol ('#').
        type: String

      - name: device_token
        description: Apple or Android Device Token.
        type: String
        required: true

      - name: user_id
        description: |
            User ID to update the subscription on behalf of. 

            Only application admins can subscribe to push notifications on behalf of other
            users.
        type: String

      - name: loc
        description: |
            Device location specified as an array with longitude as the first element and latitude
            as the second element, that is, `[longitude,latitude]`.
        type: Array<Number>

    examples:
      - platform: titanium
        example: |
            This API is not yet supported in the `ti.cloud` module.

      - platform: rest
        example: |
            The following example updates the device's location to Mountain View, CA, USA:

                $ curl -b cookies.txt -c cookies.txt -X PUT -F "device_token=<DEVICE_TOKEN>" -F "loc=[-122.0507049560547,37.38685989379883]" "http://api.cloud.appcelerator.com/v1/push_notification/subscription/update.json?key=<API_KEY>"

            Example cURL response:

                {
                  "meta": {
                    "status": "ok",
                    "code": 200,
                    "method_name": "UpdateSubscription"
                  }
                }

      - platform: ios
        example: |
            Example iOS call:

                NSMutableDictionary *paramDict = [NSMutableDictionary dictionaryWithCapacity:2];
                [paramDict setObject:[NSArray arrayWithObjects:[
                    [NSNumber numberWithFloat:-122,23],
                    [NSNumber numberWithFloat:37.12],
                    nil] forKey:@"loc"];
                [paramDict setObject:@"<DEVICE_TOKEN>" forKey:@"device_token"];
                request = [[[CCRequest alloc] initWithDelegate:self
                                              httpMethod:@"PUT"
                                              baseUrl:@"push_notifications/subscriptions/update.json"
                                              paramDict:paramDict] autorelease];
                [request startAsynchronous];
                
            SDK Callback:
            
                -(void)ccrequest:(CCRequest *)request didSucceed:(CCResponse *)response
                {
                    if ([response.meta.methodName isEqualToString:@"UpdateSubscription"]) {
                        ...
                    }
                }


      - platform: android
        example: |
            Example Android call:
            
                ACSClient sdk = new ACSClient("<YOUR APP APP KEY>"); // app key
                //ACSClient sdk = new ACSClient("<OAuth Key>", "<OAuth Secret>"); // OAuth key & secret
                
                Map<String, Object> data = new HashMap<String, Object>();
                data.put("loc", [-122.23,37.12]);
                data.put("device_token", "<DEVICE_TOKEN>");
                CCResponse response = sdk.sendRequest("push_notifications/subscription/update.json", CCRequestMethod.PUT, data);
                
            SDK Callback:
            
                JSONObject responseJSON = response.getResponseData();
                CCMeta meta = response.getMeta();
                if("ok".equals(meta.getStatus()) 
                    && meta.getCode() == 200 
                    && "UpdateSubscription".equals(meta.getMethod())) {
                  ...
                }
            
