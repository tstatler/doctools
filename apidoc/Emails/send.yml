name: Emails
methods:
  - name: email_from_template
    summary: Send Emails
    description: |
        Sends an email to a list of email addresses from your App. If you haven't
        configured your project's SMTP settings yet, please goto your App Settings and configure
        and test your SMTP setting. You also need to create at least one email
        template. The email template body supports HTML formatted text.
    url: custom_mailer/email_from_template.json
    http-method: POST

    parameters:
      - name: template
        description: |
            Name of the email template you have created.
        type: String
        required: true

      - name: recipients
        description: Comma separated list of email addresses.
        type: String
        required: true

      - name: from
        description: |
            The sender's email address. 

            <p><strong>Notes:</strong></p>

            * If you use Google as your SMTP server, the email will always be sent using the email account 
            you used to configure the SMTP service. 
            * Some SMTP service provider require the sender's email address to be present.
        type: String            

    examples:
      - platform: titanium
        example: |
            This example sends an Email and checks the response.

                Cloud.Emails.send({
                    template: 'welcome',
                    recipients: 'joe@company.com'
                }, function (e) {
                    if (e.success) {
                        alert('Success');
                    } else {
                        alert('Error:\n' +
                            ((e.error && e.message) || JSON.stringify(e)));
                    }
                });

      - platform: rest
        example: |
            Example cURL request:

                $ curl -b cookies.txt -c cookies.txt -F "recipients=joe@company.com" -F "template=welcome" https://api.cloud.appcelerator.com/v1/custom_mailer/email_from_template.json?key=<YOUR APP APP KEY>

            Example JSON response:

                {
                  "meta": {
                    "status": "ok",
                    "code": 200,
                    "method_name": "emailFromTemplate"
                  }
                }

      - platform: ios
        example: |
            Example iOS call:

                NSDictionary *paramDict = [NSDictionary dictionaryWithObjectsAndKeys:@"welcome", @"template", @"joe@company.com", @"recipients", nil ];
                CCRequest *request = [[[CCRequest alloc] initWithDelegate:self httpMethod:@"GET" baseUrl:@"custom_mailer/email_from_template.json" paramDict:paramDict] autorelease];
                [request startAsynchronous];

            SDK Callback:

                -(void)ccrequest:(CCRequest *)request didSucceed:(CCResponse *)response
                {
                	if ([response.meta.method isEqualToString:@"emailFromTemplate"]) {
                		NSLog(@"Email from template sent!");
                	}
                }

      - platform: android
        example: |
            Example Android call:

                ACSClient sdk = new ACSClient("<YOUR APP APP KEY>"); // app key
                //ACSClient sdk = new ACSClient("<OAuth Key>", "<OAuth Secret>"); // OAuth key & secret

                Map<String, Object> data = new HashMap<String, Object>();
                data.put("recipients", "joe@company.com");
                data.put("template", "welcome");
                CCResponse response = sdk.sendRequest("custom_mailer/email_from_template.json", CCRequestMethod.POST, data);

            SDK Callback:

                JSONObject responseJSON = response.getResponseData();
                CCMeta meta = response.getMeta();
                if("ok".equals(meta.getStatus())
                    && meta.getCode() == 200
                    && "emailFromTemplate".equals(meta.getMethod())) {
                  ...
                }

      - platform: javascript
        example: |
            Example Javascript call:

                var sdk = new Cocoafish('<YOUR APP APP KEY>');  // app key
                var data = {
                  recipients: 'joe@company.com',
                  template: 'welcome'
                };
                sdk.sendRequest('custom_mailer/email_from_template.json', 'POST', data, callback);

            SDK Callback:

                function callback(data) {
                  if(data) {
                    if(data.meta) {
                      var meta = data.meta;
                      if(meta.status == 'ok' && meta.code == 200 && meta.method_name == 'emailFromTemplate') {
                      	...
                      }
                    }
                  }
                }

