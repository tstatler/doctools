name: Messages
methods:

  - name: delete
    description: |
        Delete the message with the given `id`. The message must be in the current
        user's inbox or sent mail. There is currently no trash folder and deletion is
        permanent.

        Application Admin can delete any Message object.
    url: messages/delete.json
    http-method: delete
    login-required: true
    parameters:
      - name: message_id
        description: ID of the message to delete.
        type: String

      - name: user_id
        description: |
            User to delete the Message object on behalf of. The user needs to be either the sender
            or recipient of the message.

            The current user must be an application admin to delete a Message object on
            behalf of another user.
        type: String

    examples:
      - platform: titanium
        example: |
            This example deletes a message and checks the response.

                Cloud.Messages.remove({
                    message_id: savedMessageId
                }, function (e) {
                    if (e.success) {
                        alert('Removed');
                    } else {
                        alert('Error:\n' +
                            ((e.error && e.message) || JSON.stringify(e)));
                    }
                });

      - platform: rest
        example: |
            Example cURL request:

                $ curl -b cookies.txt -c cookies.txt -X DELETE "https://api.cloud.appcelerator.com/v1/messages/delete.json?key=<YOUR APP APP KEY>&pretty_json=true&message_id=4d854389d0afbe013e000029"

            Example JSON response:

                {
                  "meta": {
                    "status":"ok",
                    "code":200,
                    "method_name":"deleteMessage"
                  }
                }

      - platform: ios
        example: |
            Example iOS call:
                // Create dictionary of parameters to be passed with the request
                NSDictionary *data = @{@"message_id" : @"message_Identifier"};
                [APSMessages remove:data withBlock:^(APSResponse *e) {
                    if (e.success){
                        [[[UIAlertView alloc] initWithTitle:@"Success" 
                                                    message:@"Message Removed"
                                                   delegate:nil 
                                          cancelButtonTitle:@"OK" 
                                          otherButtonTitles:nil] show];
                    } else {
                        [[[UIAlertView alloc] initWithTitle:@"Error"
                                                    message:e.errorMessage
                                                   delegate:nil
                                          cancelButtonTitle:@"OK"
                                          otherButtonTitles:nil] show];
                    }

                }];

      - platform: ios-acssdk
        example: |
            Example iOS call:

                NSDictionary *paramDict = [NSDictionary dictionaryWithObjectsAndKeys:(CCMessage *)message.objectId, @"message_id", nil];
                CCRequest *request = [[CCRequest alloc] initWithDelegate:self  httpMethod:@"DELETE" baseUrl:@"messages/delete.json" paramDict:paramDict];
                [request startAsynchronous];
                [request release];

            SDK Callback:

                -(void)ccrequest:(CCRequest *)request didSucceed:(CCResponse *)response
                {
                	if ([response.meta.method isEqualToString:@"deleteMessage"]) {
                		NSLog(@"message deleted!");
                	}
                }

      - platform: android
        example: |
            Example Android APS SDK call:

                APSServiceManager.getInstance().enable(getApplicationContext(), 'APS_CLOUD_KEY');
                final Activity currentActivity = this;

                Map<String, Object> data = new HashMap<String, Object>();
                data.put("message_id", "4d854389d0afbe013e000029");

                try {
                    APSMessages.remove(data, new APSResponseHandler() {

                        @Override
                        public void onResponse(final APSResponse e) {
                            if (e.getSuccess()) {
                                new AlertDialog.Builder(currentActivity)
                                .setTitle("Success!").setMessage("Removed!")
                                .setPositiveButton(android.R.string.ok, null)
                                .setIcon(android.R.drawable.ic_dialog_info)
                                .show();
                            } else {
                                Log.e("APSMessages", "ERROR: " + e.getMessage());
                            }
                        }

                        @Override
                        public void onException(final APSCloudException e) {
                            Log.e("APSLikes", "Exception throw: " + e.toString());
                        }
                    });
                } catch (APSCloudException e) {
                    Log.e("APSMessages", "Exception thrown: " + e.toString());
                }

      - platform: android-acssdk
        example: |
            Example Android call:

                ACSClient sdk = new ACSClient("<YOUR APP APP KEY>"); // app key
                //ACSClient sdk = new ACSClient("<OAuth Key>", "<OAuth Secret>"); // OAuth key & secret

                Map<String, Object> data = new HashMap<String, Object>();
                data.put("message_id", "4d854389d0afbe013e000029");
                CCResponse response = sdk.sendRequest("messages/delete.json", CCRequestMethod.DELETE, data);

            SDK Callback:

                JSONObject responseJSON = response.getResponseData();
                CCMeta meta = response.getMeta();
                if("ok".equals(meta.getStatus())
                    && meta.getCode() == 200
                    && "deleteMessage".equals(meta.getMethod())) {
                  System.out.println("message deleted!");
                }

      - platform: javascript
        example: |
            Example JavaScript call:

                var sdk = new Cocoafish('<YOUR APP APP KEY>');  // app key
                var data = {
                  message_id: '4d854389d0afbe013e000029'
                };
                sdk.sendRequest('messages/delete.json', 'DELETE', data, callback);

            SDK Callback:

                function callback(data) {
                  if(data) {
                    if(data.meta) {
                      var meta = data.meta;
                      if(meta.status == 'ok' && meta.code == 200 && meta.method_name == 'deleteMessage') {
                        alert("message deleted!");
                      }
                    }
                  }
                }

      - platform: actionscript
        example: |
            Example Actionscript call:

                var sdk:Cocoafish = new Cocoafish("<YOUR APP APP KEY>"); // app key
                //var sdk:Cocoafish = new Cocoafish("<OAuth Key>", "<OAuth Secret>"); // OAuth key & secret

                var data:Object = new Object();
                data.message_id="4d854389d0afbe013e000029";
                sdk.sendRequest("messages/delete.json", URLRequestMethod.DELETE, data, false, callback);

            SDK Callback:

                function callback(data:Object):void {
                  if(data) {
                    if(data.hasOwnProperty("meta")) {
                      var meta:Object = data.meta;
                      if(meta.status == "ok" && meta.code == 200 && meta.method_name == "deleteMessage") {
                      	Alert.show("message deleted!");
                      }
                    }
                  }
                }